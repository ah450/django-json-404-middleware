# django-json-404-middleware
DJango middleware that returns 404s as JSON instead of default html response


When using Django for a restuful API, for example with DRF, it makes sense to return errors as JSON, which is what happens with 400s, 403s, etc. since they are generated by DRF themselves i.e `serializer.is_valid(raise_exception=True)` This however is not the case with 404s.
This middleware remedies this problem by intercepting 404 responses and turning them into JSON responses.

Please note that middleware [changed in django 1.10](https://docs.djangoproject.com/en/1.10/topics/http/middleware/) and thus this pacakge requires django version >= 1.10.


```python
MIDDLEWARE = [
	# Should come after any django middleware such as CommonMiddleware
	'django_json_404_middleware.JSON404Middleware',
]
```


Define a Response function and pass it in settings.py to `JSON404_DATA_RESPONSE`


```python
# in settings.py
# import mycustoomfunction
JSON_DATA_RESPONSE = mycustomfunction
```


Example of custom response function


```python
from django.http import JsonResponse


def json404_response(request):

    data = {
        "detail": "not found",
        "title": "Not found.",
        "status": 404,
        "type": "{}://{}/problems/not_found/",
    }
    data["type"] = data["type"].format(request.scheme, request.get_host())
    return JsonResponse(data, content_type="application/problem+json", status=404)
```


# Installation
`pip install django-json-404-middleware`
